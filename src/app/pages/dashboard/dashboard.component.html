<main class="dsb-container" *ngIf="storageService?.roles?.isEmployee">
    <div class="dsb-page-header">
        <h1 class="dsb-page-title">Executive Overview</h1>
        <div class="dsb-date-badge">{{today | date:'EEEE, MMMM d'}}</div>
    </div>

    <!-- Classic Stats Grid -->
    <div class="dsb-stats-grid">
        <!-- 1. Open Tasks -->
        <div class="dsb-stat-card">
            <div class="dsb-stat-icon-box icon-blue">
                <i class="ri-stack-line"></i>
            </div>
            <div class="dsb-stat-info">
                <div class="dsb-stat-label">Open Tasks</div>
                <div class="dsb-stat-value">{{dashboardData?.active_task || 0}}</div>
            </div>
        </div>
        <!-- 2. Closed Tasks -->
        <div class="dsb-stat-card">
            <div class="dsb-stat-icon-box icon-grey">
                <i class="ri-checkbox-circle-line"></i>
            </div>
            <div class="dsb-stat-info">
                <div class="dsb-stat-label">Closed Tasks</div>
                <div class="dsb-stat-value">{{dashboardData?.closed_task || 0}}</div>
            </div>
        </div>
        <!-- 3. Open Issues -->
        <div class="dsb-stat-card">
            <div class="dsb-stat-icon-box icon-red">
                <i class="ri-error-warning-line"></i>
            </div>
            <div class="dsb-stat-info">
                <div class="dsb-stat-label">Open Issues</div>
                <div class="dsb-stat-value">{{dashboardData?.active_issue || 0}}</div>
            </div>
        </div>
        <!-- 4. Closed Issues -->
        <div class="dsb-stat-card">
            <div class="dsb-stat-icon-box icon-grey">
                <i class="ri-shield-check-line"></i>
            </div>
            <div class="dsb-stat-info">
                <div class="dsb-stat-label">Closed Issues</div>
                <div class="dsb-stat-value">{{dashboardData?.closed_issue || 0}}</div>
            </div>
        </div>
        <!-- 5. Open Phases -->
        <div class="dsb-stat-card">
            <div class="dsb-stat-icon-box icon-teal">
                <i class="ri-flag-line"></i>
            </div>
            <div class="dsb-stat-info">
                <div class="dsb-stat-label">Open Phases</div>
                <div class="dsb-stat-value">{{dashboardData?.active_phase || 0}}</div>
            </div>
        </div>
        <!-- 6. Closed Phases -->
        <div class="dsb-stat-card">
            <div class="dsb-stat-icon-box icon-grey">
                <i class="ri-time-line"></i>
            </div>
            <div class="dsb-stat-info">
                <div class="dsb-stat-label">Closed Phases</div>
                <div class="dsb-stat-value">{{dashboardData?.completed_phase|| 0}}</div>
            </div>
        </div>
    </div>
    <!-- Workload Section -->
    <div class="dsb-section-divider">
        <span class="dsb-section-title" style="color: var(--primary);">
            <i class="ri-briefcase-line"></i> Workload
        </span>
        <div class="dsb-section-line"></div>
    </div>

    <div class="dsb-tables-grid">
        <!-- My Tasks -->
        <div class="dsb-table-card">
            <div class="dsb-table-header">
                <div class="dsb-table-title">
                    <span class="accent-bar bg-blue"></span> My Tasks
                </div>
                <button class="dsb-icon-btn"><i class="ri-more-fill"></i></button>
            </div>
            <div class="dsb-table-content" style="padding: 0;">
                <table class="dsb-table">
                    <div class="chart-wrapper" *ngIf="this.dashboardData?.task_list.length>0">
                        <app-issues [tasks]="this.dashboardData?.task_list"></app-issues>
                    </div>

                    <tbody *ngIf="this.dashboardData?.task_list.length==0 || !dashboardData">
                        <tr>
                            <td colspan="3">
                                <div class="dsb-empty">
                                    <i class="ri-inbox-line"></i>
                                    <span>No active tasks</span>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- My Issues -->
        <div class="dsb-table-card">
            <div class="dsb-table-header">
                <div class="dsb-table-title">
                    <span class="accent-bar bg-blue"></span> My Issues
                </div>
                <button class="dsb-icon-btn"><i class="ri-more-fill"></i></button>
            </div>
            <div class="dsb-table-content" style="padding: 0;">
                <table class="dsb-table">
                    <div class="chart-wrapper" *ngIf="this.dashboardData?.bug_list.length>0">
                        <app-issues [tasks]="this.dashboardData?.bug_list"></app-issues>
                    </div>
                    <tbody *ngIf="this.dashboardData?.bug_list.length==0 || !dashboardData">

                        <tr>
                            <td colspan="3">
                                <div class="dsb-empty">
                                    <i class="ri-bug-line"></i>
                                    <span>No issues reported</span>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <!-- Attention Section -->
    <div class="dsb-section-divider">
        <span class="dsb-section-title" style="color: var(--c-red);">
            <i class="ri-alarm-warning-line"></i> Attention Needed
        </span>
        <div class="dsb-section-line"></div>
    </div>

    <div class="dsb-tables-grid">
        <!-- Overdue -->
        <div class="dsb-table-card">
            <div class="dsb-table-header">
                <div class="dsb-table-title">
                    <span class="accent-bar bg-red"></span> Overdue Items
                </div>
                <button class="dsb-icon-btn"><i class="ri-more-fill"></i></button>
            </div>
            <div class="dsb-table-content" style="padding: 0;">
                <table class="dsb-table">
                    <div class="chart-wrapper" *ngIf="dashboardData?.overdue_items?.length>0">
                        <app-due-table [dues]="dashboardData?.overdue_items">
                        </app-due-table>
                    </div>
                    <tbody *ngIf="dashboardData?.overdue_items?.length==0 || !dashboardData">
                        <tr>
                            <td colspan=" 3">
                                <div class="dsb-empty">
                                    <i class="ri-thumb-up-line"></i>
                                    <span>All caught up!</span>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Due Today -->
        <div class="dsb-table-card">
            <div class="dsb-table-header">
                <div class="dsb-table-title">
                    <span class="accent-bar bg-grey"></span> Due Today
                </div>
                <button class="dsb-icon-btn"><i class="ri-more-fill"></i></button>
            </div>
            <div class="dsb-table-content" style="padding: 0;">
                <table class="dsb-table">
                    <div class="chart-wrapper" *ngIf="dashboardData?.today_due?.length>0">
                        <app-due-table [dues]="dashboardData?.today_due">
                        </app-due-table>
                    </div>
                    <tbody *ngIf="dashboardData?.today_due?.length==0 || !dashboardData">
                        <tr>
                            <td colspan="3">
                                <div class="dsb-empty">
                                    <i class="ri-calendar-check-line"></i>
                                    <span>Nothing due today</span>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>



</main>

<main class="dsb-container" *ngIf="storageService?.roles?.isAdmin || storageService?.roles?.isManager">
    <div class="dsb-page-header">
        <h1 class="dsb-page-title">Executive Overview</h1>
        <div class="dsb-date-badge">{{today | date:'EEEE, MMMM d'}}</div>
    </div>
    <!-- Classic Stats Grid -->
    <div class="dsb-stats-grid">
        <!-- 1. Open Tasks -->
        <div class="dsb-stat-card" (click)="navigateToPage('projects')">
            <div class="dsb-stat-icon-box icon-blue">
                <i class="ri-folder-open-line"></i>
            </div>
            <div class="dsb-stat-info">
                <div class="dsb-stat-label">Active Projects</div>
                <div class="dsb-stat-value">{{dashboardData?.active_project ||0}}</div>
            </div>
        </div>
        <!-- 2. Closed Tasks -->
        <div class="dsb-stat-card">
            <div class="dsb-stat-icon-box  icon-teal">
                <i class="ri-check-double-line"></i>
            </div>
            <div class="dsb-stat-info">
                <div class="dsb-stat-label">Completed Projects</div>
                <div class="dsb-stat-value">{{dashboardData?.completed_project || 0}}</div>
            </div>
        </div>
        <!-- 6. Closed Phases -->
        <div class="dsb-stat-card">
            <div class="dsb-stat-icon-box icon-red">
                <i class="ri-time-line"></i>
            </div>
            <div class="dsb-stat-info">
                <div class="dsb-stat-label">Dropped Projects</div>
                <div class="dsb-stat-value">{{dashboardData?.dropped || 0}}</div>
            </div>
        </div>
        <!-- 3. Open Issues -->
        <div class="dsb-stat-card">
            <div class="dsb-stat-icon-box icon-orange">
                <i class="ri-shield-check-line"></i>
            </div>
            <div class="dsb-stat-info">
                <div class="dsb-stat-label">Open Tasks</div>
                <div class="dsb-stat-value">{{dashboardData?.active_task || 0}}</div>
            </div>
        </div>
        <!-- 4. Closed Issues -->
        <div class="dsb-stat-card">

            <div class="dsb-stat-icon-box icon-red">
                <i class="ri-error-warning-line"></i>
            </div>
            <div class="dsb-stat-info">
                <div class="dsb-stat-label">Open Issues</div>
                <div class="dsb-stat-value">{{dashboardData?.active_issue || 0}}</div>
            </div>
        </div>
        <!-- 5. Open Phases -->
        <div class="dsb-stat-card">
            <div class="dsb-stat-icon-box icon-teal">
                <i class="ri-shield-user-line"></i>
            </div>
            <div class="dsb-stat-info">
                <div class="dsb-stat-label">Active Employees</div>
                <div class="dsb-stat-value">{{dashboardData?.active_employees || 0}}</div>
            </div>
        </div>

    </div>



    <!-- Workload Section -->
    <div class="dsb-section-divider">
        <span class="dsb-section-title" style="color: var(--primary);">
            <i class="ri-briefcase-line"></i> achievements
        </span>
        <div class="dsb-section-line"></div>
    </div>

    <div class="dsb-tables-grid">
        <!-- My Tasks -->
        <div class="dsb-table-card">
            <div class="dsb-table-header">
                <div class="dsb-table-title">
                    <span class="accent-bar bg-blue"></span> Projects status report
                </div>
                <button class="dsb-icon-btn"><i class="ri-more-fill"></i></button>
            </div>
            <div class="dsb-table-content">
                <div class="dsb-table">
                    <div class="chart-wrapper">
                        <app-project-status
                            [dataValues]="[this.dashboardData?.active_project, this.dashboardData?.completed_project, this.dashboardData?.dropped_projects]"></app-project-status>
                        <tbody *ngIf="false">
                            <tr>
                                <td colspan="3">
                                    <div class="dsb-empty">
                                        <i class="ri-inbox-line"></i>
                                        <span>No active tasks</span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </div>
                </div>
            </div>
        </div>

        <!-- My Issues -->
        <div class="dsb-table-card">
            <div class="dsb-table-header">
                <div class="dsb-table-title">
                    <span class="accent-bar bg-blue"></span> Teams Performance <div
                        style="display: flex; justify-content: end;">
                        <select (change)="onDepartmentChange($event)" class="dsb-select">
                            <option *ngFor="let d of dashboardData?.departmentwise_project_details"
                                [value]="d.departmen_name">
                                {{ d.departmen_name }}
                            </option>
                        </select>
                    </div>
                </div>
                <button class="dsb-icon-btn"><i class="ri-more-fill"></i></button>
            </div>
            <div class="dsb-table-content">
                <div class="dsb-table" style="display: flex; justify-content: center; align-items: center;">
                    <div class="chart-wrapper" *ngIf="dashboardData?.departmentwise_project_details?.length>0">
                        <app-project-team-report
                            [projectData]="dashboardData?.departmentwise_project_details"></app-project-team-report>
                    </div>
                    <tbody *ngIf="dashboardData?.departmentwise_project_details?.length==0 || !dashboardData">
                        <tr>
                            <td colspan="3">
                                <div class="dsb-empty">
                                    <i class="ri-bug-line"></i>
                                    <span>No issues reported</span>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </div>

            </div>
        </div>
    </div>
    <!-- Attention Section -->
    <div class="dsb-section-divider">
        <span class="dsb-section-title" style="color: var(--c-red);">
            <i class="ri-alarm-warning-line"></i> Attention Needed
        </span>
        <div class="dsb-section-line"></div>
    </div>

    <div class="dsb-tables-grid">
        <!-- Overdue -->
        <div class="dsb-table-card">
            <div class="dsb-table-header">
                <div class="dsb-table-title">
                    <span class="accent-bar bg-red"></span> Overdue Items
                </div>
                <button class="dsb-icon-btn"><i class="ri-more-fill"></i></button>
            </div>
            <div class="dsb-table-content" style="padding: 0;">
                <table class="dsb-table">
                    <div class="chart-wrapper" *ngIf="dashboardData?.overdue_items?.length>0">
                        <app-due-table [dues]="dashboardData?.overdue_items">
                        </app-due-table>
                    </div>
                    <tbody *ngIf="dashboardData?.overdue_items?.length==0 || !dashboardData">
                        <tr>
                            <td colspan="3">
                                <div class="dsb-empty">
                                    <i class="ri-thumb-up-line"></i>
                                    <span>All caught up!</span>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Due Today -->
        <div class="dsb-table-card">
            <div class="dsb-table-header">
                <div class="dsb-table-title">
                    <span class="accent-bar bg-grey"></span> Due Today
                </div>
                <button class="dsb-icon-btn"><i class="ri-more-fill"></i></button>
            </div>
            <div class="dsb-table-content" style="padding: 0;">
                <table class="dsb-table">
                    <app-due-table *ngIf="dashboardData?.today_due?.length>0" [dues]="dashboardData?.today_due">
                    </app-due-table>
                    <tbody *ngIf="dashboardData?.today_due?.length==0 || !dashboardData">
                        <tr>
                            <td colspan="3">
                                <div class="dsb-empty">
                                    <i class="ri-calendar-check-line"></i>
                                    <span>Nothing due today</span>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</main>